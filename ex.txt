#include <bits/stdc++.h>
using namespace std;
int maxSub1(int a[],int n) {
	int max_sum= INT_MIN;
	for(int i=0;i<=n;i++) {
		for(int j=i;j<=n;j++) {
			int sum=0;
			for(int k=i;k<=j;k++) sum+=a[k];
			if(max_sum<sum) max_sum=sum;
		}
	}
	return max_sum+0;
}
int maxSub2(int a[], int n) {
	int max_sum= INT_MIN;
	for(int i=0;i<=n;i++) {
		int sum=0;
		for(int j=i;j<=n;j++) {
			sum+=a[j];
			if(max_sum<sum) max_sum=sum;
		}
	}
	return max_sum;
}
int max_left(int a[],int low, int high){
	int sum=0,max_sum=INT_MIN;
	for(int i=high;i>=low;i--) {
		sum+=a[i];
		if(max_sum<sum) {
			max_sum=sum;
		}
	}
	return max_sum;
}
int max_right(int a[],int low, int high){
	int sum=0,max_sum=INT_MIN;
	for(int i=low;i<=high;i++) {
		sum+=a[i];
		if(max_sum<sum) {
			max_sum=sum;
		}
	}
	return max_sum;
}
int maxSub3(int a[],int low, int high) {
	if(low==high) return a[low]; 
	int mid=(low+high)/2;
	int ml=maxSub3(a, low, mid);
	int mr=maxSub3(a,mid+1,high);
	int mm=max_left(a,low,mid)+max_right(a,mid+1,high);
	int M=max(ml,mr);
	M=max(M,mm);
	return M;
}
int maxSub4(int a[],int n) {
	int smax=a[0];
	int ei=a[0];
	int imax=0;
	for(int i=1;i<=n;i++) {
		int u=ei+a[i];
		int v=a[i];
		if(u>v) {
			ei=u;
		}
		else {
			ei=v;
		}
		if(ei>smax) {
			smax=ei;
			imax=i;
		}
	}
	return smax;
}
int main() {
	srand(time(NULL));
	int n,t;
	cout<<"Nhap so phan tu: ";cin>>n;
	int* a=new int [n];
	for(int i=0;i<n;i++) a[i]=rand()%1000-500;
	clock_t t1,t2;
	double d;
	t1=clock();
	t=maxSub1(a,n-1);
	t2=clock();
	cout<<"Duyet toan bo: "<<t<<"    With the "<<"executive time: "<<setprecision(5)<<fixed<<(t2-t1)/(double)(CLOCKS_PER_SEC)<<endl;
	t1=clock();
	t=maxSub2(a,n-1);
	t2=clock();
	cout<<"Duyet toan bo cai tien: "<<t<<"    With the "<<"executive time: "<<setprecision(5)<<fixed<<(t2-t1)/(double)(CLOCKS_PER_SEC)<<endl;
	t1=clock();
	t=maxSub3(a,0,n-1);
	t2=clock();
    d=(t2-t1)/(double)(CLOCKS_PER_SEC);
	cout<<"Chia de tri: "<<t<<"    With the "<<"executive time: "<<setprecision(5)<<fixed<<d<<endl;
	t1=clock();
	t=maxSub4(a,n-1);
	t2=clock();
	d=(t2-t1)/(double)(CLOCKS_PER_SEC);
	cout<<"Quy hoach dong: "<<t<<"    With the "<<"executive time: "<<setprecision(5)<<fixed<<d<<endl;
	return 0;
}
